
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>何幻</title>
  <meta name="author" content="thzt">

  
  <meta name="description" content="有个楚国人，坐船渡河时不慎把剑掉入河中。 他在船上用刀刻下记号，说：“这是我的剑掉下去的地方。” 当船停下时，他沿着记号跳入河中找剑，遍寻不获。 这就是刻舟求剑的故事。 听起来，这个楚国人太傻了。 这么明显的道理，居然想不明白。 然而，你笑别人的时候，其实别人也正在笑你。 要明白其中的道理， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://thzt.github.io/posts/75/" />
  <link type="favicon" rel="shortcut icon" href="/favicon.ico" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <link href="/atom.xml" rel="alternate" title="何幻" type="application/atom+xml" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.useso.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.useso.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">何幻</a></h1>
  
    <h2>Programming is about ideas, languages are just a way to express them.</h2>
  
</hgroup>


<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "//hm.baidu.com/hm.js?33605c59a8749f3e0404d9f438b66667";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
	<li><a href="/">Newest</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/16/evolution/">刻舟求剑</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-12-16T00:00:00+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>有个楚国人，坐船渡河时不慎把剑掉入河中。</p>

<p>他在船上用刀刻下记号，说：“这是我的剑掉下去的地方。”</p>

<p>当船停下时，他沿着记号跳入河中找剑，遍寻不获。</p>

<p><br/></p>

<p>这就是刻舟求剑的故事。</p>

<p>听起来，这个楚国人太傻了。</p>

<p>这么明显的道理，居然想不明白。</p>

<p><br/></p>

<p>然而，你笑别人的时候，其实别人也正在笑你。</p>

<p>要明白其中的道理，这还要从头说起。</p>

<p><br/></p>

<p>软件，在外行人眼里，似乎很神秘。</p>

<p>他们看到的每一行代码，都是处于同等层次上的。</p>

<p>计算机只要把这些文本顺序过一遍，就能做相应的事情。</p>

<p><br/></p>

<p>然而，在软件从业者看来，事情是复杂的。</p>

<p>这些文本之间是有层次关系的。</p>

<p>各行之前互相依赖， 牵一发而动全身。</p>

<p><br/></p>

<p>那么，让我们随着软件规模的增长，来一探这些层次关系的建立过程吧。</p>

<p>我们将看到人们的认识，是随着软件规模的发展而逐渐丰富的。</p>

<p>没有任何技术手段，是凭空出现的。</p>

<p><br/></p>

<p>这也提醒我们，不要过度使用不必要的技术。</p>

<p>技术水平应当契合软件的发展程度。</p>

<h3><strong>0-50行：美好的开端</strong></h3>

<p><br/></p>

<p>如果，你实现了一个功能，写了50行代码。</p>

<p>那么，一屏幕就足以容纳它们了。</p>

<p>甚至，全部默写到另一个电脑上，也是可以的。</p>

<p><br/></p>

<p>这里面可能包含了一些简单的控制结构，顺序，选择，循环。</p>

<p>所有的计算过程尽收眼底。</p>

<p>世界真美妙。</p>

<h3><strong>50-500行：提取代码片段</strong></h3>

<p><br/></p>

<p>如果，你实现了一个功能，写了500行代码。</p>

<p>那么，一个文件就足以容纳它们了。</p>

<p><br/></p>

<p>你可以把这个文件拷贝到另一个地方使用。</p>

<p>但是重新再写一遍代码，你是不想再做了。</p>

<p><br/></p>

<p>随着规模的增长，函数出现的。</p>

<p>因为软件功能复杂了，你不得不在很多地方做相似的事情。</p>

<p>函数的出现，并不是为了追求花哨，而是不得已而为之。</p>

<p><br/></p>

<p><a href="http://zh.wikipedia.org/wiki/%E5%87%BD%E6%95%B8%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80">函数式语言</a>的世界或许并不如此。</p>

<p>一开始就有函数。</p>

<p>那么，也可以这样说，处理相同逻辑的代码片段被提取出来了。</p>

<h3><strong>500-2000行：隔离状态</strong></h3>

<p><br/></p>

<p>如果，你实现了一个功能，写了2000行代码。</p>

<p>那么，一个文件夹就足以容纳它们了。</p>

<p><br/></p>

<p>如果需要的话，你可以把文件夹打包发送。</p>

<p>对于重新建立文件，重新写代码，你都不想做了。</p>

<p><br/></p>

<p>随着规模的增长，代码中出现了共享数据。</p>

<p>函数A和函数B要处理一段数据，但是函数C并不参与。</p>

<p>所以，把多个函数以及它们的共享数据放到一起，是个好主意。</p>

<p><br/></p>

<p><a href="http://zh.wikipedia.org/wiki/%E5%B0%81%E8%A3%9D_(%E7%89%A9%E4%BB%B6%E5%B0%8E%E5%90%91%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88">封装</a>)和隔离，这就是<a href="http://zh.wikipedia.org/wiki/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">面向对象程序设计</a>的根本思想。</p>

<p>函数式语言的世界里，这称为<a href="http://zh.wikipedia.org/wiki/%E9%97%AD%E5%8C%85">闭包</a>。</p>

<p><a href="http://zh.wikipedia.org/wiki/Haskell">纯函数式语言</a>的世界里，状态隐含在顺序里面，于是出现了<a href="http://zh.wikipedia.org/wiki/%E5%8D%95%E5%AD%90">monad</a>这种有趣的事物。</p>

<p><br/></p>

<p><a href="http://zh.wikipedia.org/wiki/%E7%B1%BB_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">类</a>)，其实是跟原始面向对象无关的概念。</p>

<p>类是产生对象的其中一种手段，是一个模板，来生成对象。</p>

<p>除此之外，你或者还可以使用<a href="http://zh.wikipedia.org/wiki/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F">原型</a>，来复制出一个对象。</p>

<p><br/></p>

<p><a href="http://zh.wikipedia.org/wiki/%E7%BB%A7%E6%89%BF">继承</a>，也提供了一种代码复用方案。</p>

<p>但是，不分情况的坚持使用类和继承，是自找麻烦。</p>

<p>当然，不分情况的使用任何东西，都是自找麻烦。</p>

<h3><strong>2000-5000行：规范化</strong></h3>

<p><br/></p>

<p>如果，你实现了一个功能，写了5000行代码。</p>

<p>那么，可能就需要一个目录结构了。</p>

<p><br/></p>

<p>这些目录中，有可能你用到了第三方的组件。</p>

<p>用到了同事或自己以前的代码库。</p>

<p>而且你明白了，可能你正在做的这个功能本身也只是一个中间产品。</p>

<p><br/></p>

<p>你发现了一个高大上的概念，<a href="http://zh.wikipedia.org/wiki/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F_(%E8%AE%A1%E7%AE%97%E6%9C%BA">设计模式</a>)。</p>

<p>好像你不用设计模式，就无法跟别人进行交流一样。</p>

<p>于是，有些人膜拜它，有些人无视它。</p>

<p><br/></p>

<p>然而，两个极端都不好，我们既要了解必要性，也要了解局限性。</p>

<p><br/></p>

<p>设计模式降低了交流的成本。</p>

<p>设计模式还规范化了千奇百怪的设计。</p>

<p>我们避免重复阅读设计细节，也能为找到解决方案提供了思路。</p>

<p><br/></p>

<p>但是，设计模式也不完美。</p>

<p>模式方案，可能不是最佳方案。</p>

<p>大量出现的模式，使代码千篇一律，增加了冗余度。</p>

<p><br/></p>

<p>因此，在支持<a href="http://zh.wikipedia.org/wiki/%E5%85%83%E7%BC%96%E7%A8%8B">元编程</a>的语言里，几乎很少提到模式。</p>

<p>但是，无视模式并不能表示你精通元编程。</p>

<p>这是两码事。</p>

<p><br/></p>

<p>同时，代码清理和<a href="http://zh.wikipedia.org/wiki/%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84">重构</a>也会提到日程上来。</p>

<p>以及相关的一些提高代码质量的手段。例如，</p>

<p><a href="http://zh.wikipedia.org/wiki/%E7%BB%93%E5%AF%B9%E7%BC%96%E7%A8%8B">结对编程</a>，<a href="http://zh.wikipedia.org/wiki/%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5">代码审查</a>，<a href="http://zh.wikipedia.org/wiki/%E6%B5%8B%E8%AF%95%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91">测试驱动开发</a>等，都耳熟能详了。</p>

<p><br/></p>

<p>于是，在这种规模的软件开发上，合作成了重要的话题。</p>

<p><a href="http://zh.wikipedia.org/wiki/%E8%BD%AF%E4%BB%B6%E8%BF%87%E7%A8%8B">软件项目管理</a>，开始有用武之地了。</p>

<h3><strong>还是2000-5000行：世界观的转变</strong></h3>

<p><br/></p>

<p>现在，你有了5000行代码，功能也实现了。</p>

<p>世界因此就美好了吗。</p>

<p>经验表明，事实不是如此啊。</p>

<p><br/></p>

<p>每一次的需求变更，都会导致一定规模代码的改写。</p>

<p>当然灵活性，易扩展的软件架构会减小负担。</p>

<p>但也难免受到冲击。</p>

<p><br/></p>

<p>随着业务的复杂化，如何定位问题，都已经成为问题了。</p>

<p>为了避免无止尽的重写，返工。</p>

<p>专门的<a href="http://zh.wikipedia.org/wiki/%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90">需求分析</a>，开始有人做了。</p>

<p><br/></p>

<p>由于软件规模变大了，软件项目的参与者也增加了。</p>

<p>大家可能在同时修改代码，有的人也想看看昨天的代码是什么样的。</p>

<p>于是，引入了<a href="http://zh.wikipedia.org/wiki/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6">版本控制</a>。</p>

<p><br/></p>

<p>别人改了一处代码，结果影响了你的功能，这太常见了。</p>

<p>但是，怎样才能发现的早一些呢，最好在他改的时候，就告诉他。</p>

<p><a href="http://zh.wikipedia.org/wiki/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">单元测试</a>可以帮助你。</p>

<p><br/></p>

<p>目录结构中文件太多了，每一次集成，部署到生产环境，手动处理是很麻烦的。</p>

<p>如果能自动安装部署就好了。</p>

<p><a href="http://baike.baidu.com/view/5253255.htm">自动化部署</a>，也加上。</p>

<p><br/></p>

<p>还有很多很多。</p>

<p><br/></p>

<p>为什么会增加这么多额外的工作？</p>

<p>软件到底怎么了？</p>

<p><br/></p>

<p>这些其实揭露了软件业不同于其他产业的一个显著特征。</p>

<p>那就是，软件是无时无刻不在变化中的。</p>

<p>软件是它生命期内，这个历史过程中的一个瞬间写照。</p>

<p><br/></p>

<p>就像前文所说的刻舟求剑的例子一样，</p>

<p>我们应该用发展的眼光来看待软件开发。</p>

<p>这一事实，在软件规模足够大时，就越发明显起来了。</p>

<h3><strong>5000-10000行：自动化</strong></h3>

<p><br/></p>

<p>可以说，<a href="http://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">计算机科学</a>就是研究什么可以自动化的学科。</p>

<p>编程语言描述了自动化的处理过程。</p>

<p>自动化处理，让我们有迹可循。</p>

<p><br/></p>

<p>在大规模软件项目中进行编码时，手动处理一切是不现实的，更是不适合的。</p>

<p>没有自动化的控制，我们几乎寸步难行。</p>

<p><br/></p>

<p>我们不敢修改一行代码，因为我们无法知道后果是什么。</p>

<p>我们不敢修改一个类，因为它可能在成千上百个文件中都用到了。</p>

<p>我们不敢删除一个文件，因为它可能被某个模块动态调用。</p>

<p><br/></p>

<p>那怎么办？</p>

<p>我们只能用软件本身来处理软件的问题了。</p>

<p>软件是用来处理复杂度的，那么当软件规模足够复杂时，</p>

<p>用软件来处理软件的复杂度，这种想法也是合情合理的。</p>

<p><br/></p>

<p>所以，大规模软件项目，并不是一蹴而就的。</p>

<p>都有一个漫长的成长过程。</p>

<p>而伴随其成长的，是相关的辅助工具。</p>

<p><br/></p>

<p>有第三方的合适工具可用的话，我们会尽量发挥软件的杠杆效应。</p>

<p>站在巨人的肩膀上。</p>

<p>如果没有的话，我们要有能力有意识的去制作工具。</p>

<p><br/></p>

<p>人有别于其他动物的特点，不就是能制作工具吗？</p>

<p>我们还可以制作制作工具的工具。</p>

<p><br/></p>

<p>这就是软件赋予我们的能力。</p>

<h3><strong>结语</strong></h3>

<p>软件是一个发展过程，</p>

<p>思想跟不上软件规模的发展，就会走得艰难，</p>

<p>而追求不切实际的技术手段，也是枉费力气。</p>

<p><br/></p>

<p>软件的价值，在于存活期内它能为使用者带来多大效益。</p>

<p>这真是，春蚕到死丝方尽，蜡炬成灰泪始干呀。</p>

<p><br/></p>

<p>就让我们把软件当做一路同行的知心朋友，</p>

<p>携手并肩，共同走向美好的未来吧。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/76">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/74">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
	<h1>Categories</h1>
	<ul id="categories">
		<li class='category'><a href='/blog/categories/design/'>design (10)</a></li>
<li class='category'><a href='/blog/categories/haskell/'>haskell (6)</a></li>
<li class='category'><a href='/blog/categories/lisp/'>lisp (17)</a></li>
<li class='category'><a href='/blog/categories/logic/'>logic (4)</a></li>
<li class='category'><a href='/blog/categories/mind/'>mind (29)</a></li>
<li class='category'><a href='/blog/categories/software/'>software (12)</a></li>

	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/05/16/pain-oriented-design/">面向痛点的应变之道</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/05/12/break-through-the-bottleneck/">如何突破瓶颈</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/27/surprise-move/">出奇制胜</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/18/education-and-career/">教育和职业</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/14/alphago/">观看AlphaGo与李世石比赛有感</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/11/tools/">论工具</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/08/forward-looking-engineer/">软件工程师的前瞻性</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/06/game-theory-in-team-building/">团队建设中的博弈论</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/01/proof-and-deduction/">形式证明与逻辑推理</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/29/computer-science/">真实在哪里</a>
      </li>
    
  </ul>
</section>

<section>
	<h1>GitHub Repos</h1>
	
	
    <ul>
        <li><a href="https://github.com/thzt">@thzt</a> on GitHub</li>
    </ul>
	
	
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - thzt -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
